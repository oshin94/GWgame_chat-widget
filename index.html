<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Chat Widget</title>
    <script src="https://unpkg.com/@buildshipapp/chat-widget@^1" defer></script>
    <style>
        /* Basic page setup */
        html, body {
            height: 100%;
            margin: 0;
            overflow: hidden; /* Prevent double scrollbars */
        }

        #chat-container {
            height: 100vh; /* Full viewport height */
            display: flex;
            flex-direction: column;
            justify-content: flex-end; /* Ensure input stays at the bottom */
            transition: height 0.3s ease; /* Smooth transition when resizing */
        }

        button {
            padding: 10px;
            font-size: 16px;
        }
    </style>
</head>
<body>
    <div id="chat-container">
        <!-- Button to open the widget -->
        <button data-buildship-chat-widget-button>Open Chat</button>
    </div>

    <script>
        function adjustContainerHeight() {
            const chatContainer = document.getElementById('chat-container');
            const newHeight = window.innerHeight;
            chatContainer.style.height = `${newHeight}px`; // Adjust the container height to the new viewport height
        }

        function handleFocus() {
            const chatContainer = document.getElementById('chat-container');
            // Check if the viewport height decreased by more than a certain percentage (indicating the keyboard opened)
            const originalHeight = window.innerHeight;
            
            window.addEventListener('resize', () => {
                const currentHeight = window.innerHeight;

                if (currentHeight < originalHeight * 0.7) {
                    // If the viewport height reduces (keyboard open), reduce the chat container height
                    chatContainer.style.height = `${currentHeight*0.6}px`;
                } else {
                    // Restore original height when the keyboard is closed
                    chatContainer.style.height = `100vh`;
                }
            });
        }

        window.addEventListener('load', () => {
            adjustContainerHeight(); // Adjust on page load
            
            // Initialize your chat widget
            window.buildShipChatWidget.config.url = "https://dz3l1w.buildship.run/groundwater";
            window.buildShipChatWidget.config.greetingMessage = "Hi Player!!! Imagine you are a new entrant in the development sector placed in a rural Indian village, you have an exciting career ahead. But for that you have to find innovative solutions to challenges you will face in your career. Keep your answers descriptive and not just 2-4 words. When you are ready, type START and press enter.";
            window.buildShipChatWidget.config.closeOnOutsideClick = false;
            window.buildShipChatWidget.config.openOnLoad = true;

            // Adjust layout when keyboard is visible
            handleFocus();
        });
    </script>
</body>
</html>
